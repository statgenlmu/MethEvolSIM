load("C:/Users/ricca/Bachelor_simulation/Nikolas_simulation/out_tips/nikolas_dataSIM_01.RData")
View(tip_list)
tip_list
tip_list[[1]]$combi$get_singleStr(1)$get_seq()
load("C:/Users/ricca/Bachelor_simulation/Nikolas_simulation/out_tips/nikolas_dataSIM_01.RData")
tip_list[[1]]$combi$get_singleStr(1)$get_seq()
View(tip_list)
load("C:/Users/ricca/Bachelor_simulation/Nikolas_simulation/out_tips/nikolas_dataSIM_01.RData")
tip_list[[1]]$combi$get_singleStr(1)$get_seq()
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
tip_list[[1]]$combi$get_singleStr(3)$get_seq()
label_list_islands <- list(rep(NA,tip_num),rep(NA,tip_num))
tip_num <- 2
label_list_islands <- list(rep(NA,tip_num),rep(NA,tip_num))
label_list_nonislands <- list(rep(NA,tip_num),rep(NA,tip_num),rep(NA,tip_num))
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
convert_global_methylation = function(seq){
seq[seq==1] <- 0
seq[seq==2] <- 0.5
seq[seq==3] <- 1
return(seq)
}
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
tip_list[[1]]$combi$get_singleStr(4)$get_seq()
convert_global_methylation(tip_list[[1]]$combi$get_singleStr(2)$get_seq())
mean(convert_global_methylation(tip_list[[1]]$combi$get_singleStr(2)$get_seq()))
mean(c(1,0.5,0))
tip_list[[1]]$combi$get_singleStr(4)$get_seq()
label_list_islands
tip_list[[2]]$combi$get_singleStr(2)$get_seq()
tip_list[[4]]$combi$get_singleStr(2)$get_seq()
tip_list[[2]]$combi$get_singleStr(2)$get_seq()
tip_list[[2]]$combi$get_singleStr(2)$get_seq()
tip_list[[4]]$combi$get_singleStr(2)$get_seq()
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
label_list_islands
tip_list[[1]]$combi$get_singleStr(1)$get_seq()
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
tip_list[[1]]$combi$get_singleStr(4)$get_seq()
tip_list[[2]]$combi$get_singleStr(2)$get_seq()
tip_list[[2]]$combi$get_singleStr(1)$get_seq()
tip_list[[2]]$combi$get_singleStr(4)$get_seq()
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
tip_list[[2]]$combi$get_singleStr(2)$get_seq()
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
tip_list[[2]]$combi$get_singleStr(2)$get_seq()
tip_list[[2]]$combi$get_singleStr(4)$get_seq()
tip_list[[1]]$combi$get_singleStr(4)$get_seq()
tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
samples <- 2
tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
tajima_island <- tajima_island_z/tajima_island_n
tajima_island
tajima_nonisland_z <- sum(unlist(label_list_nonislands[[1]]) == "u")* sum(unlist(label_list_nonislands[[1]]) == "o")+sum(unlist(label_list_nonislands[[2]]) == "u")* sum(unlist(label_list_nonislands[[2]]) == "o")+sum(unlist(label_list_nonislands[[3]]) == "u")* sum(unlist(label_list_nonislands[[3]]) == "o")
tajima_nonisland_n <- choose(samples,2)*3
tajima_nonisland <- tajima_nonisland_z/tajima_nonisland_n
tajima_nonisland
label_list_islands[[1]][[1]] <- "u"
tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
tajima_island <- tajima_island_z/tajima_island_n
tajima_island
tajima_island_n <- choose(samples,2)*2
tajima_island_n
sum(unlist(label_list_islands[[1]]) == "u")
sum(unlist(label_list_islands[[1]]) == "o")
label_list_islands[[1]]
label_list_islands[[1]][[2]]
i1_list <- list()
i2_list <- list()
for (i in 1:length(label_list_islands)) {
i1_list <- append(i1_list,label_list_islands[[i]][[1]])
i2_list <- append(i2_list,label_list_islands[[i]][[2]])
}
i2_list
i2_list[[1]]
i2_list[[2]]
unlist(i2_list)
sum(unlist(i1_list) == "u")
i1_list
sum(unlist(i1_list) == "o")
sum(unlist(i1_list) == "u") * sum(unlist(i1_list) == "o") + sum(unlist(i2_list) == "u") * sum(unlist(i2_list) == "o")
tajima_nonisland_z/tajima_nonisland_n
tajima_island_z/tajima_island_n
tajima_island_z <- sum(unlist(i1_list) == "u") * sum(unlist(i1_list) == "o") + sum(unlist(i2_list) == "u") * sum(unlist(i2_list) == "o")
#tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
tajima_island <- tajima_island_z/tajima_island_n
tajima_island
choose(samples,2)*2
ni1_list <- list()
ni2_list <- list()
ni3_list <- list()
for (i in 1:length(label_list_nonislands)) {
ni1_list <- append(ni1_list,label_list_nonislands[[i]][[1]])
ni2_list <- append(ni2_list,label_list_nonislands[[i]][[2]])
ni3_list <- append(ni3_list,label_list_nonislands[[i]][[3]])
}
tip_num
tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
tajima_island <- tajima_island_z/tajima_island_n
tajima_island
label_list_islands <- list(list("o","o","u"),list("u","o","o"))
label_list_nonislands <- list(list("u","u","o"),list("o","u","u"),list("o","u","u"))
i1_list <- list()
i2_list <- list()
for (i in 1:length(label_list_islands)) {
i1_list <- append(i1_list,label_list_islands[[i]][[1]])
i2_list <- append(i2_list,label_list_islands[[i]][[2]])
}
ni1_list <- list()
ni2_list <- list()
ni3_list <- list()
for (i in 1:length(label_list_nonislands)) {
ni1_list <- append(ni1_list,label_list_nonislands[[i]][[1]])
ni2_list <- append(ni2_list,label_list_nonislands[[i]][[2]])
ni3_list <- append(ni3_list,label_list_nonislands[[i]][[3]])
}
tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
tajima_island <- tajima_island_z/tajima_island_n
tajima_island
sum(unlist(label_list_islands[[1]]) == "u")
sum(unlist(label_list_islands[[1]]) == "o")
sum(unlist(label_list_islands[[2]]) == "u")
sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_z
choose(samples,2)*2
samples <- 3
choose(samples,2)*2
tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
tajima_island <- tajima_island_z/tajima_island_n
tajima_island
tajima_nonisland_z <- sum(unlist(label_list_nonislands[[1]]) == "u")* sum(unlist(label_list_nonislands[[1]]) == "o")+sum(unlist(label_list_nonislands[[2]]) == "u")* sum(unlist(label_list_nonislands[[2]]) == "o")+sum(unlist(label_list_nonislands[[3]]) == "u")* sum(unlist(label_list_nonislands[[3]]) == "o")
tajima_nonisland_n <- choose(samples,2)*3
tajima_nonisland <- tajima_nonisland_z/tajima_nonisland_n
tajima_nonisland
tip_list
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
tip_list[[2]]$combi$get_singleStr(2)$get_seq()
tip_list[[3]]$combi$get_singleStr(2)$get_seq()
View(label_list_islands)
View(label_list_islands)
View(tip_list)
length(label_list_islands)
tip_list[[1]]$combi$get_singleStr(1)$get_seq()
tip_list[[1]]$combi$get_singleStr(2)$get_seq()
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
tip_list
#loop each tip
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
length(tip_list)
tip_list[[1]]$combi$get_singleStr_number()
tip_list[[2]]$combi$get_singleStr_number()
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
print("test")
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
print("test")
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
label_list_islands
sim_num <- sub(".*_([0-9]+)\\.RData$", "\\1", tips_list[[i]])
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
tip_num
length(tip_list)
label_list_islands <- list(rep(NA,tip_num),rep(NA,tip_num))
label_list_nonislands <- list(rep(NA,tip_num),rep(NA,tip_num),rep(NA,tip_num))
View(label_list_nonislands)
for(j in 1:length(tip_list)){
#loop each ssg
for(k in 1:tip_list[[j]]$combi$get_singleStr_number()){
if(k == 2 || k==4){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_islands[[k/2]][[j]] <- "u"
}
else{
label_list_islands[[k/2]][[j]] <- "o"
}
}
else if(k==1){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[1]][[j]] <- "u"
}
else{
label_list_nonislands[[1]][[j]] <- "o"
}
}
else if(k==3){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[2]][[j]] <- "u"
}
else{
label_list_nonislands[[2]][[j]] <- "o"
}
}
else if(k==5){
if(mean(convert_global_methylation(tip_list[[j]]$combi$get_singleStr(k)$get_seq()))<0.5){
label_list_nonislands[[3]][[j]] <- "u"
}
else{
label_list_nonislands[[3]][[j]] <- "o"
}
}
}
}
tajima_island_z <- sum(unlist(label_list_islands[[1]]) == "u")* sum(unlist(label_list_islands[[1]]) == "o") + sum(unlist(label_list_islands[[2]]) == "u")* sum(unlist(label_list_islands[[2]]) == "o")
tajima_island_n <- choose(samples,2)*2
tajima_island <- tajima_island_z/tajima_island_n
tajima_island
tajima_island_z
sum(unlist(label_list_islands[[1]]) == "u")
tajima_nonisland_z <- sum(unlist(label_list_nonislands[[1]]) == "u")* sum(unlist(label_list_nonislands[[1]]) == "o")+sum(unlist(label_list_nonislands[[2]]) == "u")* sum(unlist(label_list_nonislands[[2]]) == "o")+sum(unlist(label_list_nonislands[[3]]) == "u")* sum(unlist(label_list_nonislands[[3]]) == "o")
tajima_nonisland_n <- choose(samples,2)*3
tajima_nonisland <- tajima_nonisland_z/tajima_nonisland_n
tajima_nonisland
install.packages("mgcv")
install.packages("nlme")
)
install.packages("lattice")
install.packages("Matrix")
